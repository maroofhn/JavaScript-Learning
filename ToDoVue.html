<!DOCTYPE html>
<html>

<!--Head Section, Link CSS-->
<head>
  <title>To Do List</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Vend+Sans:ital,wght@0,300..700;1,300..700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="todostyles.css">
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>

<body>
  <div id="app">
    <h1>Vue Todo List</h1>

    <!--Take input from user, when user press enter, execute addTask method-->
    <input v-model="newTask" placeholder="Add a task" v-on:keyup.enter="addTask">

    <!--If User does not press enter and presses Add Button, execute addTask method-->
    <button v-on:click="addTask">Add</button>

    <!--Display that if no tasks are there-->
    <p v-if="tasks.length === 0">No tasks yet!</p>

    <!--Creates List, searches in tasks-->
        <ul>
        <todo-item
            v-for="(task, index) in tasks"
            :key="index"
            :task="task"
            v-on:remove="removeTask(index)"
            v-on:toggle="toggleComplete(index)"
        ></todo-item>
        </ul>

  </div>

  <!-- app.js Link -->
  <script>
    // Component TodoItem
    const TodoItem = {
      props: ['task'],
      template: `
        <li class="todo-item">
          <span :class="{ completed: task.completed }" @click="$emit('toggle')">
            {{ task.text }}
          </span>
          <button @click="$emit('remove')">Delete</button>
        </li>
      `
    }

    // Creating Vue App
    const app = Vue.createApp({
      components: { TodoItem },

      // For Declaring Variables or Arrays
      data() {
        return {
          newTask: '',
          tasks: []
        }
      },

      // All Methods for the Program
      methods: {
        addTask() {
          if (this.newTask.trim() === '') return;
          this.tasks.push({ text: this.newTask, completed: false });
          this.newTask = '';
        },

        removeTask(index) { 
          this.tasks.splice(index, 1);
        },

        toggleComplete(index) {
          this.tasks[index].completed = !this.tasks[index].completed;
        }
      },

      // All Lifecycle methods
      created() {
        const saved = localStorage.getItem('tasks');
        if (saved) this.tasks = JSON.parse(saved);
      },

      updated() {
        localStorage.setItem('tasks', JSON.stringify(this.tasks));
      }
    });

    app.mount('#app');
  </script>
</body>
</html>
